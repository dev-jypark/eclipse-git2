<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="fridge.mybatis.mapper.notice">
  
  	<resultMap type="noticeDTO" id="noticeDTOResult">
		<!-- 
		property:자바빈(OneMemoDTO)의 속성명
		column:테이블의 컬럼(조회(SELECT)결과의 컬럼명들 의미)
		 -->
		<result column="n_no" property="n_no"/>
		<result column="n_title" property="n_title"/>
		<result column="n_content" property="n_content"/>
		<result column="n_hit" property="n_hit"/>
		<result column="n_postDate" property="n_postDate"/>
	</resultMap>
  
  	<!-- 관리자 로그인여부 확인 -->
  	<select id="isAdmin" parameterType="Map" resultType="int">
		SELECT COUNT(*) FROM admin WHERE adminid=#{adminid} AND adminpw=#{adminpw}		
	</select>

	<select id="noticeSelectList" parameterType="Map" resultType="noticeDTO">
		SELECT * FROM notice ORDER BY n_no DESC
	</select>
	
	<select id="noticeTotalRowCount" parameterType="Map" resultType="int">
		SELECT COUNT(*) FROM notice
	</select>
	
	<insert id="noticeInsert" parameterType="Map" >
		INSERT INTO notice(n_no,adminid,n_title,n_content)
		VALUES(SEQ_NOTICE_N_NO.NEXTVAL,#{adminid},#{n_title},#{n_content})
	</insert>
	
	<select id="noticeSelectOne" parameterType="Map" resultMap="noticeDTOResult">
		SELECT * FROM notice WHERE n_no=#{n_no}	
	</select>
	
	<update id="noticeUpdate" parameterType="Map">
		UPDATE notice SET n_title=#{n_title},n_content=#{n_content} WHERE n_no=#{n_no}
	</update>
	
	<delete id="noticeDelete" parameterType="Map">
		DELETE notice WHERE n_no=#{n_no}
	</delete>
	
	<!-- 조회수 증가처리 -->
	<update id = "increaseHit" parameterType="String">
	<!-- 글번호에 해당하는 조회수를 +1하는 쿼리문 -->
		update notice set n_hit=n_hit+1 where n_no=#{n_no}
	</update>
	
  </mapper>