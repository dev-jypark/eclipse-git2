<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="fridge.mybatis.mapper.userchart">
  
  	<resultMap type="userchartDTO" id="userchartDTOResult">
		<!-- 
		property:자바빈(OneMemoDTO)의 속성명
		column:테이블의 컬럼(조회(SELECT)결과의 컬럼명들 의미)
		 -->
		<result column="q_no" property="q_no"/>
		<result column="id" property="id"/>
		<result column="q_title" property="q_title"/>
		<result column="q_content" property="q_content"/>
		<result column="q_postdate" property="q_postdate"/>
		<result column="q_secret" property="q_secret"/>
		<result column="originNo" property="originNo"/>
		<result column="groupOrd" property="groupOrd"/>
	</resultMap>
  
  	<!-- 회원 로그인여부 확인 -->
  	<select id="isLogin" parameterType="Map" resultType="int">
		SELECT COUNT(*) FROM member WHERE id=#{id} AND pwd=#{pwd}		
	</select>
	
	<!-- 게시글 수 -->
	<select id="userchartpost" parameterType="Map" resultType="int">
		SELECT COUNT(*) FROM f_bbs WHERE id=#{id}
	</select>
	
	<!-- 회원 수 -->
	<select id="userchartmember" parameterType="Map" resultType="int">
		SELECT COUNT(*) FROM member WHERE id=#{id}
	</select>
	
	<!-- 댓글 수 -->
	<select id="userchartcomment" parameterType="Map" resultType="int">
		SELECT COUNT(*) FROM f_com WHERE id=#{id}
	</select>
	
	<!-- 일단 보류 -->
	<select id="questionSelectOne" parameterType="Map" resultMap="questionDTOResult">
		SELECT * FROM q_bbs WHERE q_no=#{q_no}	
	</select>
	
	<update id="questionUpdate" parameterType="Map">
		UPDATE q_bbs SET q_title=#{q_title},q_content=#{q_content} WHERE q_no=#{q_no}
	</update>
	
	<delete id="questionDelete" parameterType="Map">
		DELETE q_bbs WHERE q_no=#{q_no}
	</delete>
	
	<select id="getBoardReplyInfo" parameterType="Map" resultType="questionDTO">
    
	    SELECT q_no
	         , originNo
	         , groupOrd
	         , groupLayer
	    FROM q_bbs
	    WHERE originNo = #{q_no}
 
	</select>
	
	<insert id="questionInsertReply" parameterType="Map" >
		INSERT INTO q_bbs(q_no,id,q_title,q_content,originNo,groupOrd)
		VALUES(SEQ_Q_BBS.NEXTVAL,#{id},#{q_title},#{q_content},{q_no},#{groupOrd}+1)
	</insert>
	
  </mapper>